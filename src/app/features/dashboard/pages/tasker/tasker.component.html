<p-tabView [activeIndex]="(activeTabIndex$ | async) ?? 0" (onChange)="onTabviewChange($event)">
  <p-tabPanel [header]="'tasker.title' | translate">
    @if (isTasksLoading$ | async) {
      <div class="flex justify-content-center">
        <p-progressSpinner />
      </div>
    } @else {
      @if (tasksData$ | async; as data) {
        <div class="container">
          <div class="flex gap-6 align-items-center flex-wrap">
            <p-selectButton
              [options]="filters"
              [allowEmpty]="false"
              [(ngModel)]="data.filter"
              (onChange)="taskFilterChange($event)"
              optionLabel="label"
              optionValue="data" />
          </div>

          <ul class="grid-container">
            @for (task of data.tasks; track task.id) {
              <li>
                <ctrl-task
                  [task]="task"
                  (toggleIsTaskComplete)="toggleIsTaskComplete($event)"
                  (toggleIsStepComplete)="toggleIsStepComplete($event)"
                  (removeTask)="removeTask($event)" />
              </li>
            }

            <li>
              <ctrl-container [noPadding]="true" styleClass="" class="h-full">
                <p-button [text]="true" severity="secondary" [icon]="PrimeIcons.PLUS" (onClick)="addTask()" styleClass="w-full h-full" />
              </ctrl-container>
            </li>
          </ul>
        </div>
      }
    }
  </p-tabPanel>

  <p-tabPanel [header]="'tasker.notes' | translate">
    @if (isNotesLoading$ | async) {
      <div class="flex justify-content-center">
        <p-progressSpinner />
      </div>
    } @else {
      @defer {
        @if (notesData$ | async; as data) {
          <div class="container">
            @if (data.notes.length) {
              <p-toggleButton
                [onIcon]="PrimeIcons.ARROW_UP"
                [offIcon]="PrimeIcons.ARROW_DOWN"
                [(ngModel)]="data.filter"
                (onChange)="noteFilterChange($event)" />
            }

            <ul class="m-0">
              @for (note of data.notes; track note.id) {
                <li class="my-3">
                  <ctrl-note [note]="note" (removeNote)="removeNote($event)" class="flex-grow-1" />
                </li>
              }

              <li>
                <ctrl-container [noPadding]="true">
                  <p-button [text]="true" [icon]="PrimeIcons.PLUS" (onClick)="addNote()" severity="secondary" styleClass="w-full py-3" />
                </ctrl-container>
              </li>
            </ul>
          </div>
        }
      }
    }
  </p-tabPanel>
</p-tabView>
