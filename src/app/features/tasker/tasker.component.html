<p-tabView [activeIndex]="state.activeTabIndex" (onChange)="onTabviewChange($event)">
  <p-tabPanel [header]="'tasker.title' | translate">
    @if (state.isTasksLoading) {
      <div class="flex justify-content-center">
        <p-progressSpinner />
      </div>
    } @else {
      @if (state.tasksData; as data) {
        <div class="container">
          <div class="flex justify-content-between align-items-center">
            <div class="dropdown-wrapper">
              <small class="block mb-2"> {{ 'common.status' | translate }}</small>
              <p-dropdown
                optionLabel="label"
                optionValue="data"
                styleClass="w-full"
                [options]="filters"
                [(ngModel)]="data.filter"
                (onChange)="taskFilterChange($event)" />
            </div>

            <p-button size="small" [text]="true" [icon]="PrimeIcons.PLUS" (onClick)="addTask()" />
          </div>

          <ul class="flex-container">
            @for (task of data.tasks; track task.id) {
              <li>
                <org-task
                  [task]="task"
                  (editTask)="editTask($event)"
                  (removeTask)="removeTask($event)"
                  (toggleIsTaskComplete)="toggleIsTaskComplete($event)"
                  (toggleIsStepComplete)="toggleIsStepComplete($event)" />
              </li>
            }

            <li class="max-w-19rem">
              <org-container>
                <p-button
                  severity="secondary"
                  styleClass="w-full h-full py-3"
                  [text]="true"
                  [icon]="PrimeIcons.PLUS"
                  (onClick)="addTask()" />
              </org-container>
            </li>
          </ul>
        </div>
      }
    }
  </p-tabPanel>

  <p-tabPanel [header]="'tasker.notes' | translate">
    @if (state.isNotesLoading) {
      <div class="flex justify-content-center">
        <p-progressSpinner />
      </div>
    } @else {
      @defer {
        @if (state.notesData; as data) {
          <div class="container">
            @if (data.notes.length) {
              <p-toggleButton
                [onIcon]="PrimeIcons.ARROW_UP"
                [offIcon]="PrimeIcons.ARROW_DOWN"
                [(ngModel)]="data.filter"
                (onChange)="noteFilterChange($event)" />
            }

            <ul class="flex-container">
              @for (note of data.notes; track note.id) {
                <li>
                  <org-note class="flex-grow-1" [note]="note" (editNote)="editNote($event)" (removeNote)="removeNote($event)" />
                </li>
              }

              <li class="max-w-19rem">
                <org-container>
                  <p-button severity="secondary" styleClass="w-full py-3" [text]="true" [icon]="PrimeIcons.PLUS" (onClick)="addNote()" />
                </org-container>
              </li>
            </ul>
          </div>
        }
      }
    }
  </p-tabPanel>
</p-tabView>
